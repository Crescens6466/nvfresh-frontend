<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>NvFresh Admin â€“ Products</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ================= ADMIN NAVBAR ================= -->
<header class="admin-navbar">
  <div class="admin-brand">ğŸ§‘â€ğŸ’¼ NvFresh Admin</div>

  <nav class="admin-nav-links">
    <a href="products.html">ğŸ“¦ Products</a>
    <a href="orders.html">ğŸ§¾ Orders</a>
    <a href="login.html" id="adminLoginBtn">ğŸ” Login</a>
    <a href="#" id="adminLogoutBtn" style="display:none;">ğŸšª Logout</a>
  </nav>
</header>

<!-- ================= PAGE TITLE ================= -->
<h2 class="page-title">ğŸ§‘â€ğŸ’¼ NvFresh â€“ Product Management</h2>

<!-- ================= ADD PRODUCT FORM ================= -->
<div class="form">
  <input type="text" id="name" placeholder="Product name" />

  <select id="category">
    <option value="fish">Fish</option>
    <option value="prawns">Prawns</option>
  </select>

  <input type="number" id="price" placeholder="Price per kg" />

  <input type="file" id="image" accept="image/*" />

  <button onclick="addProduct()">Add Product</button>
</div>

<hr>

<!-- ================= PRODUCTS TABLE ================= -->
<h3>Available Products</h3>

<table class="admin-table">
  <thead>
    <tr>
      <th>Name</th>
      <th>Category</th>
      <th>Price (â‚¹/kg)</th>
      <th>Image</th>
      <th>Status</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody id="productTable"></tbody>
</table>

<!-- ================= SCRIPTS ================= -->
<script src="products.js"></script>

<script>
/* =========================
   ADMIN SESSION CHECK
========================= */
async function checkAdmin() {
  try {
    const res = await fetch("/api/admin/me", {
      credentials: "include"
    });

    if (res.ok) {
      document.getElementById("adminLoginBtn").style.display = "none";
      document.getElementById("adminLogoutBtn").style.display = "inline";
    } else {
      document.getElementById("adminLoginBtn").style.display = "inline";
      document.getElementById("adminLogoutBtn").style.display = "none";
    }
  } catch (err) {
    document.getElementById("adminLoginBtn").style.display = "inline";
    document.getElementById("adminLogoutBtn").style.display = "none";
  }
}

/* =========================
   ADMIN LOGOUT
========================= */
document.getElementById("adminLogoutBtn").addEventListener("click", async (e) => {
  e.preventDefault();

  await fetch("/api/admin/logout", {
    method: "POST",
    credentials: "include"
  });

  window.location.href = "login.html";
});

/* =========================
   INIT
========================= */
checkAdmin();
</script>

</body>
</html>
